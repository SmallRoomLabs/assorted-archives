// *******************************************************************************************************************************
// *******************************************************************************************************************************
//
//		Name:		xd_tape_windows.cpp
//		Purpose:	External Drivers : Windows Cassette I/O
//		Created:	28th October 2015
//		Author:		Paul Robson (paul@robsons.org.uk)
//
// *******************************************************************************************************************************
// *******************************************************************************************************************************

#include <stdio.h>
#include "drivers.h"

static FILE *fTapeOut;														// Tape output file
static FILE *fTapeIn;														// Tape input file

// *******************************************************************************************************************************
//													Initialise Tape
// *******************************************************************************************************************************

void XDTapeInit(void) {
	fTapeOut = fopen("tape.out","wb");										// Open tape input/output files.
	fTapeIn = fopen("tape.in","rb");
}

// *******************************************************************************************************************************
//													Read bit from tape
// *******************************************************************************************************************************

BYTE8 XDTapeReadBit(void) {
	if (fTapeIn == NULL || feof(fTapeIn)) return 1; 						// 1 is default value.
	return fgetc(fTapeIn) & 1;
}

// *******************************************************************************************************************************
//													Write bit to tape
// *******************************************************************************************************************************

void XDTapeWriteBit(BYTE8 bit) {
	if (fTapeOut != NULL) fputc(bit ? '1':'0',fTapeOut);
}

